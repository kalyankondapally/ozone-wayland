From 446205ae15a94ca14b67567c12e24b83e6b30eee Mon Sep 17 00:00:00 2001
From: Kondapally Kalyan <kalyan.kondapally@intel.com>
Date: Sat, 7 Dec 2013 11:38:35 +0200
Subject: [PATCH] Add x11 checks in InputMethodManagerImpl.

---
 .../input_method/input_method_manager_impl.cc      |    6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/chrome/browser/chromeos/input_method/input_method_manager_impl.cc b/chrome/browser/chromeos/input_method/input_method_manager_impl.cc
index 496e6ab..b623d66 100644
--- a/chrome/browser/chromeos/input_method/input_method_manager_impl.cc
+++ b/chrome/browser/chromeos/input_method/input_method_manager_impl.cc
@@ -349,12 +349,14 @@ bool InputMethodManagerImpl::ChangeInputMethodInternal(
     current_input_method_ = *descriptor;
   }
 
+#if defined(USE_X11)
   // Change the keyboard layout to a preferred layout for the input method.
   if (!xkeyboard_->SetCurrentKeyboardLayoutByName(
           current_input_method_.GetPreferredKeyboardLayout())) {
     LOG(ERROR) << "Failed to change keyboard layout to "
                << current_input_method_.GetPreferredKeyboardLayout();
   }
+#endif
 
   // Update input method indicators (e.g. "US", "DV") in Chrome windows.
   FOR_EACH_OBSERVER(InputMethodManager::Observer,
@@ -706,9 +708,9 @@ void InputMethodManagerImpl::InitializeComponentExtension() {
 
 void InputMethodManagerImpl::Init(base::SequencedTaskRunner* ui_task_runner) {
   DCHECK(thread_checker_.CalledOnValidThread());
-
+#if defined(USE_X11)
   xkeyboard_.reset(XKeyboard::Create());
-
+#endif
   // We can't call impl->Initialize here, because file thread is not available
   // at this moment.
   ui_task_runner->PostTask(
-- 
1.7.9.5

